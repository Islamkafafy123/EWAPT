# Introduction
- Adobe Flash is a technology used to create video, animations and other rich content.
- can be used as standalone applications or be embedded in HTML pages.
- Adobe provides a `scripting language called ActionScript
- Flash ActionScript needs to be compiled before execution. The compiled object is in SWF format
- To embed a Flash animation within a web page, you can use an object element with Content-type : application/x-shockwave-Flash
- HTML page can embed the Flash animation and specify a param element with the attribute `allowScriptAccess` to describe the policy for communication between the animation and the parent HTML page
- allowScriptAccess
	- Always : The SWF file can always communicate with the HTML page
	- sameDomain : communicate with the HTML if they share the same domain.
	- Never : The SWF file can never communicate with the HTML page
- pass arguments to Flash files
  - Direct reference : Flash is not embedded in an HTML page and arguments are provided directly through the URI
  - Flash Embedded in HTML page : arguments are passed through the attribute data  of the object element.
  - FlashArgs attribute : Flash is embedded in the HTML page and arguments are passed through the attribute FlashArgs of the object element
# Flash Security Model
- Sandbox and stakeholder important concepts in the Flash security paradigm
- By default, SWF files hosted on the subdomain
- StakeHolders
  - describe different roles (human or not) involved in the control of security settings.
	- There are four stakeholders: administrator, user, website, and author.
	- Flash security checks are performed, starting from the first stakeholder
	- Each stakeholder can enforce security controls using different means.
- Administrative Rule 
	- Who :
		-  configure Flash security settings that will affect all operating system users.
	- How : 
		- `mms.cfg` : This text configuration file is read when Flash player starts,
		-  `The Global Flash Player Trust director` : Administrators can register SWF files as trusted for all operating system users.
- User Rule
	- Who : 
		- The user role is represented by the operating system user running a Flash animation through the player
	- How : 
		- Settings manager, Settings UI , such as: camera and microphone settings, shared object storage settings, settings related to legacy content, and so on.
		- User Flash Player Trust directory : Users can register SWF files as trusted
- Website Rule
	- Who :
		- web server component responsible for the delivery of the Flash animation and/or Flash resources to the client.
	- How :
    - Policy File : is a file placed in a specific location on the web server
    - `Note` that this policy file can grant or deny access to resources stored on the current server enforcing the policy.
    - such as : SWF (images, text files, or other SWF files).
    - Depending on the requested resource, ActionScript can initiate two different types of connection:
      - Document-based server connection for ActionScript objects
        - Loader (to load SWF files or images JPG,PNG,GIF)
        - Sound
        - URLLoader (to load text or binary data)
        - URLStream
      - Socket connection for ActionScript objects
        - Actionscript socket
        - XMLSocket
   - This policy file is checked by the Flash player if it is a document-based server connection.
   - This policy file is also known as the Master policy file.
   - A SWF file can check for policy files in different locations by calling the Security.loadPolicyFile() method
- Author Rule
  - Who : 
	- The author role is represented by the developer of the Flash animation.
	- This role can affect the interaction between SWF files available on different domains.
  - How :
	- The API `Security.allowDomain(<allowedDomain>)` : grants permissions to the following features:
		- Interaction between different SWF files (Flash Cross-Scripting)
		- Display list access
		- Event detection
		- Full access to properties and methods of the Stage object
- By default, an SWF file cannot access the ActionScript properties and methods of another SWF file available on a different domain.
- Access is granted only if the accessed SWF allows the domain of the calling SWF.
- To achieve this goal, the API call Security.allowDomain()
- When Flash animations are embedded in HTML pages, ActionScript code (available in the SWF file) can call the parent pageâ€™s JavaScript code by using the ExternalInterface class.
- When Flash animations are embedded in HTML pages, JavaScript code can call Actionscript code included in the embedded Flash file.
- The method has the following definition - navigateToURL(URLRequest, [target]).
- This ActionScript method is used to open a URL in the window embedding the Flash file. == js Function `window.open`
- The parameter URLRequest can contain JavaScript code, such as `javascript: alert('Hello from Actionscript.');`
- the JavaScript code will be run only if one of the following conditions is true:
  - the SWF file is a locally trusted file
  - SWF file is embedded and the allowScriptAccess rules described above apply
  - the target and the SWF file are part of the same sandbox (they are located in the same subdomain)
- If input sanitization does not occur, this method can be exploited by malicious users
- Flash features an internal storage mechanism based on Local Shared Objects :  similar to browser cookies:
  - They can be used to track user activity or to store preferences.
  - They are read only by subdomains that have set them.
  - There are also some significant differences:
    - They are not sent back and forth over HTTP connections.
    - They do not expire
    - They are stored in a dedicated Flash directory, and are shared by all browsers on a system.
    - They can contain complex (and large amounts of) data, so they offer the advanced features of local storage.
    - To create or retrieve a local shared object with ActionScript:
    `var myCookie:SharedObject = SharedObject.getLocal("information");`
      - If the shared object information exists, its properties are retrieved and saved into the object myCookie;	
# Flash Vulnerabilities    
