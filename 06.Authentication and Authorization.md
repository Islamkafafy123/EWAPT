# Introduction
- Authentication is determining whether somone who he calims to be or not
- its a protection mechanism that ensures that contents are accessed only if the user has the right to do so
- webapp rely on username and password to authenticate
- Diff between Authentcation and Authorization
  - Authentication : Verifying who you are
  - Authorization : what are you able to do
- Authentication Factor represent something the user owns , knows or is
  - ownership factor
  - knowledge factor
  - inherence factor
- Ownershio Factor
  - something the user has
  - Ex :- Security Token , Mobile Phone ,bank online token
- Knowledge Factor
  - Something the user know
  - Ex :- Password ,PIN or secret Question
- Inherence Factor
  - Something the user is
  - Ex :- Fingerprint Signeture , Face retinal Pattern
- Single Factor Authentication Method require user to provide single one of the three authentication methods
- Two Factor Authentication of MFA ( multi) require a user to provide two or more authentication method
  - like ATM (Pin And CARD )
# Common Vulnurabilities
- IF channel is not encrypted and attacker can steal creds using man in the middle attack
- if password does not adhere to strong password policy its exposed to attacks like ( Dictinary Attacks ,Brute Force Attack )
- Dictionary Attack
  - involve Quering the Authentication System With a wordlists
- BruteForce Attack
  - The Attack tries To use every Possible Combination of Charachters to guess the Password
- Defending From indequate password Policy
  - Strong Password Policy
    - length
    - never use the same password twice
    - dont include personal info
    - change password monthly or annualy
  - Storing hashes
    - password need to be hashhed with salt before they are stored
  - Lockout/Blocking Policy
    - block authentication Request Coming From and attacker
- User Enumration
  - user can authenticate to app if only user and password are correct
  - web app could reveal info about existing user
- Dont inform attacker about which credintial is wrong and make
- User Enumration via website behavior
  - if user exist new cookie is set if user is not present cookies are deleted
  - if user exist go to a user specific page if not present go to a known fixed page
  - if user exist html changes if not html is fixed
- User Enumeration via timing attack
  - if user exist in db there will be more processing
    - if user exist : retrieve user ,calculate pass ,check if pass is matching
    - if user dont exist : show error + abort
- Check Video
- check for default creds
- The Remember me Functionality
  - Through browser Cache
  - storng creds perma in web storage
  - storing creds within the cookie
- password must not be cached
- xss attack steal cookie if no httponly flag
- session hijacking via packet sniffing
- value stored in a cookie is much longer time that of session
- webstorage is a container accessable and writable by all pages sharing the same origin so attacker can acces it via xss
- Best Defensive Techniques
  - autocomplete off in html
  - encrypt password before storing it in the cookie
  - encrypt password before storing in the webstorage
- secret questions are a critic components in authenticaion just like another password
- to avoid dictionary and bruteforce attacks the webapp must limit the answer attempts and block request coming from malicious user
- never use unlimited attempts in a webapp alwasy limit it
- typical weaknesses of password reset link
  - guessable password reset link
    - the link does not contain a random token
  - predictable password reset token
    - the token must be discarded once used 
  - recycable password reset link
    - the link triggaring the password  reset can be used more than once
    - so random token is not enought it should be discarde after its use
- web apps should create password reset link according to
  - the link should contain a token
  - token should abide a certain rules
- Logout Weaknesses
  - incorrect session destruction
    - server dont properly destroy session after a logout operation
- CAPTCHA
  - small added security against attackers

# Bypassing Authorization  
- trying to access protected contents without logging in
- Insecure Direct Object References
  - some pages can be accessed by unauthorized users if web dev dont set proper controlls
  - refernce become insecure if web app dont validate the input parametar proberly
  - attacker can manipulate to access other objects
- best Defense Techniques
  -  each protected page must contain a prologue
  -  prologue is code written is server side that determine if the user has access to resources or not and if not terminate script-
- Missing function level acces control
  - attacker can change parameter or the url to access privileged function not in objects like above
  - check example from page 102 to 108
- terminate scripts execution after inserting the redirect
- check video
- web apps manage authentication by assigning unique token to each authenticated session known as session identifier will be sent to the user by the server after successfull login then resent by the user in http header embedded in url or cookies
- session identifier can be guessed if it is not predictable
- if attacker find valid session identifier he will be able to impersonate user without creds
- SQL injection is part of Authentication and Authorization
- Local file inclusion and PAth traversal happen when web app tries to retrieve files from file system an dont sanitize the user input
- Path Traversal
  - allows attackers to retrieve files from webserver that are not intended to be accessed
- Local File Inclusion
  - type of path traversal that allow attacker to access or execute code of a local file
- both happen when user input is part of the file path
- %00 url encoded version of null charachter 

